{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { useForkRef } from '@mui/material/utils';\nimport { defaultMemoize } from 'reselect';\nimport { useGridApiContext } from '../../utils/useGridApiContext';\nimport { useGridSelector } from '../../utils/useGridSelector';\nimport { gridVisibleColumnDefinitionsSelector, gridColumnPositionsSelector } from '../columns/gridColumnsSelector';\nimport { gridTabIndexColumnHeaderSelector, gridTabIndexCellSelector, gridFocusColumnHeaderSelector } from '../focus/gridFocusStateSelector';\nimport { gridDensityHeaderHeightSelector } from '../density/densitySelector';\nimport { gridFilterActiveItemsLookupSelector } from '../filter/gridFilterSelector';\nimport { gridSortColumnLookupSelector } from '../sorting/gridSortingSelector';\nimport { gridColumnMenuSelector } from '../columnMenu/columnMenuSelector';\nimport { useGridRootProps } from '../../utils/useGridRootProps';\nimport { useGridApiEventHandler } from '../../utils/useGridApiEventHandler';\nimport { GridEvents } from '../../../models/events';\nimport { GridColumnHeaderItem } from '../../../components/columnHeaders/GridColumnHeaderItem';\nimport { getFirstColumnIndexToRender } from '../columns/gridColumnsUtils';\nimport { useGridVisibleRows } from '../../utils/useGridVisibleRows';\nimport { getRenderableIndexes } from '../virtualization/useGridVirtualScroller';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction isUIEvent(event) {\n  return !!event.target;\n}\n\nexport const useGridColumnHeaders = props => {\n  const {\n    innerRef: innerRefProp,\n    minColumnIndex = 0\n  } = props;\n  const [dragCol, setDragCol] = React.useState('');\n  const [resizeCol, setResizeCol] = React.useState('');\n  const apiRef = useGridApiContext();\n  const visibleColumns = useGridSelector(apiRef, gridVisibleColumnDefinitionsSelector);\n  const columnPositions = useGridSelector(apiRef, gridColumnPositionsSelector);\n  const tabIndexState = useGridSelector(apiRef, gridTabIndexColumnHeaderSelector);\n  const cellTabIndexState = useGridSelector(apiRef, gridTabIndexCellSelector);\n  const columnHeaderFocus = useGridSelector(apiRef, gridFocusColumnHeaderSelector);\n  const headerHeight = useGridSelector(apiRef, gridDensityHeaderHeightSelector);\n  const filterColumnLookup = useGridSelector(apiRef, gridFilterActiveItemsLookupSelector);\n  const sortColumnLookup = useGridSelector(apiRef, gridSortColumnLookupSelector);\n  const columnMenuState = useGridSelector(apiRef, gridColumnMenuSelector);\n  const rootProps = useGridRootProps();\n  const innerRef = React.useRef(null);\n  const handleInnerRef = useForkRef(innerRefProp, innerRef);\n  const [renderContext, setRenderContext] = React.useState(null);\n  const prevRenderContext = React.useRef(renderContext);\n  const prevScrollLeft = React.useRef(0);\n  const currentPage = useGridVisibleRows(apiRef, rootProps);\n  React.useEffect(() => {\n    apiRef.current.columnHeadersContainerElementRef.current.scrollLeft = 0;\n  }, [apiRef]); // memoize `getFirstColumnIndexToRender`, since it's called on scroll\n\n  const getFirstColumnIndexToRenderRef = React.useRef(defaultMemoize(getFirstColumnIndexToRender, {\n    equalityCheck: (a, b) => ['firstColumnIndex', 'minColumnIndex', 'columnBuffer'].every(key => a[key] === b[key])\n  }));\n  const updateInnerPosition = React.useCallback(nextRenderContext => {\n    const [firstRowToRender, lastRowToRender] = getRenderableIndexes({\n      firstIndex: nextRenderContext.firstRowIndex,\n      lastIndex: nextRenderContext.lastRowIndex,\n      minFirstIndex: 0,\n      maxLastIndex: currentPage.rows.length,\n      buffer: rootProps.rowBuffer\n    });\n    const firstColumnToRender = getFirstColumnIndexToRenderRef.current({\n      firstColumnIndex: nextRenderContext.firstColumnIndex,\n      minColumnIndex,\n      columnBuffer: rootProps.columnBuffer,\n      firstRowToRender,\n      lastRowToRender,\n      apiRef,\n      visibleRows: currentPage.rows\n    });\n    const offset = firstColumnToRender > 0 ? prevScrollLeft.current - columnPositions[firstColumnToRender] : prevScrollLeft.current;\n    innerRef.current.style.transform = `translate3d(${-offset}px, 0px, 0px)`;\n  }, [columnPositions, minColumnIndex, rootProps.columnBuffer, apiRef, currentPage.rows, rootProps.rowBuffer]);\n  React.useLayoutEffect(() => {\n    if (renderContext) {\n      updateInnerPosition(renderContext);\n    }\n  }, [renderContext, updateInnerPosition]);\n  const handleScroll = React.useCallback(({\n    left,\n    renderContext: nextRenderContext = null\n  }, event) => {\n    var _prevRenderContext$cu, _prevRenderContext$cu2;\n\n    if (!innerRef.current) {\n      return;\n    } // Ignore vertical scroll.\n    // Excepts the first event which sets the previous render context.\n\n\n    if (prevScrollLeft.current === left && ((_prevRenderContext$cu = prevRenderContext.current) == null ? void 0 : _prevRenderContext$cu.firstColumnIndex) === (nextRenderContext == null ? void 0 : nextRenderContext.firstColumnIndex) && ((_prevRenderContext$cu2 = prevRenderContext.current) == null ? void 0 : _prevRenderContext$cu2.lastColumnIndex) === (nextRenderContext == null ? void 0 : nextRenderContext.lastColumnIndex)) {\n      return;\n    }\n\n    prevScrollLeft.current = left; // We can only update the position when we guarantee that the render context has been\n    // rendered. This is achieved using ReactDOM.flushSync or when the context doesn't change.\n\n    let canUpdateInnerPosition = false;\n\n    if (nextRenderContext !== prevRenderContext.current || !prevRenderContext.current) {\n      // ReactDOM.flushSync cannot be called on `scroll` events fired inside effects\n      if (isUIEvent(event)) {\n        // To prevent flickering, the inner position can only be updated after the new context has\n        // been rendered. ReactDOM.flushSync ensures that the state changes will happen before\n        // updating the position.\n        ReactDOM.flushSync(() => {\n          setRenderContext(nextRenderContext);\n        });\n        canUpdateInnerPosition = true;\n      } else {\n        setRenderContext(nextRenderContext);\n      }\n\n      prevRenderContext.current = nextRenderContext;\n    } else {\n      canUpdateInnerPosition = true;\n    } // Pass directly the render context to avoid waiting for the next render\n\n\n    if (nextRenderContext && canUpdateInnerPosition) {\n      updateInnerPosition(nextRenderContext);\n    }\n  }, [updateInnerPosition]);\n  const handleColumnResizeStart = React.useCallback(params => setResizeCol(params.field), []);\n  const handleColumnResizeStop = React.useCallback(() => setResizeCol(''), []);\n  const handleColumnReorderStart = React.useCallback(params => setDragCol(params.field), []);\n  const handleColumnReorderStop = React.useCallback(() => setDragCol(''), []);\n  useGridApiEventHandler(apiRef, GridEvents.columnResizeStart, handleColumnResizeStart);\n  useGridApiEventHandler(apiRef, GridEvents.columnResizeStop, handleColumnResizeStop);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderDragStart, handleColumnReorderStart);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderDragEnd, handleColumnReorderStop);\n  useGridApiEventHandler(apiRef, GridEvents.rowsScroll, handleScroll);\n\n  const getColumns = (params, other = {}) => {\n    const {\n      renderContext: nextRenderContext = renderContext,\n      minFirstColumn = minColumnIndex,\n      maxLastColumn = visibleColumns.length\n    } = params || {};\n\n    if (!nextRenderContext) {\n      return null;\n    }\n\n    const columns = [];\n    const [firstRowToRender, lastRowToRender] = getRenderableIndexes({\n      firstIndex: nextRenderContext.firstRowIndex,\n      lastIndex: nextRenderContext.lastRowIndex,\n      minFirstIndex: 0,\n      maxLastIndex: currentPage.rows.length,\n      buffer: rootProps.rowBuffer\n    });\n    const firstColumnToRender = getFirstColumnIndexToRenderRef.current({\n      firstColumnIndex: nextRenderContext.firstColumnIndex,\n      minColumnIndex: minFirstColumn,\n      columnBuffer: rootProps.columnBuffer,\n      apiRef,\n      firstRowToRender,\n      lastRowToRender,\n      visibleRows: currentPage.rows\n    });\n    const lastColumnToRender = Math.min(nextRenderContext.lastColumnIndex + rootProps.columnBuffer, maxLastColumn);\n    const renderedColumns = visibleColumns.slice(firstColumnToRender, lastColumnToRender);\n\n    for (let i = 0; i < renderedColumns.length; i += 1) {\n      const column = renderedColumns[i];\n      const columnIndex = firstColumnToRender + i;\n      const isFirstColumn = columnIndex === 0;\n      const hasTabbableElement = !(tabIndexState === null && cellTabIndexState === null);\n      const tabIndex = tabIndexState !== null && tabIndexState.field === column.field || isFirstColumn && !hasTabbableElement ? 0 : -1;\n      const hasFocus = columnHeaderFocus !== null && columnHeaderFocus.field === column.field;\n      const open = columnMenuState.open && columnMenuState.field === column.field;\n      columns.push( /*#__PURE__*/_jsx(GridColumnHeaderItem, _extends({}, sortColumnLookup[column.field], {\n        columnMenuOpen: open,\n        filterItemsCounter: filterColumnLookup[column.field] && filterColumnLookup[column.field].length,\n        headerHeight: headerHeight,\n        isDragging: column.field === dragCol,\n        column: column,\n        colIndex: columnIndex,\n        isResizing: resizeCol === column.field,\n        isLastColumn: columnIndex === visibleColumns.length - 1,\n        extendRowFullWidth: !rootProps.disableExtendRowFullWidth,\n        hasFocus: hasFocus,\n        tabIndex: tabIndex\n      }, other), column.field));\n    }\n\n    return columns;\n  };\n\n  const rootStyle = {\n    minHeight: headerHeight,\n    maxHeight: headerHeight,\n    lineHeight: `${headerHeight}px`\n  };\n  return {\n    renderContext,\n    getColumns,\n    isDragging: !!dragCol,\n    getRootProps: (other = {}) => _extends({\n      style: rootStyle\n    }, other),\n    getInnerProps: () => ({\n      ref: handleInnerRef,\n      'aria-rowindex': 1,\n      role: 'row'\n    })\n  };\n};","map":{"version":3,"sources":["C:/Users/Valerio/Documents/GitHub/EsamePaw/ReactApp/node_modules/@mui/x-data-grid/hooks/features/columnHeaders/useGridColumnHeaders.js"],"names":["_extends","React","ReactDOM","useForkRef","defaultMemoize","useGridApiContext","useGridSelector","gridVisibleColumnDefinitionsSelector","gridColumnPositionsSelector","gridTabIndexColumnHeaderSelector","gridTabIndexCellSelector","gridFocusColumnHeaderSelector","gridDensityHeaderHeightSelector","gridFilterActiveItemsLookupSelector","gridSortColumnLookupSelector","gridColumnMenuSelector","useGridRootProps","useGridApiEventHandler","GridEvents","GridColumnHeaderItem","getFirstColumnIndexToRender","useGridVisibleRows","getRenderableIndexes","jsx","_jsx","isUIEvent","event","target","useGridColumnHeaders","props","innerRef","innerRefProp","minColumnIndex","dragCol","setDragCol","useState","resizeCol","setResizeCol","apiRef","visibleColumns","columnPositions","tabIndexState","cellTabIndexState","columnHeaderFocus","headerHeight","filterColumnLookup","sortColumnLookup","columnMenuState","rootProps","useRef","handleInnerRef","renderContext","setRenderContext","prevRenderContext","prevScrollLeft","currentPage","useEffect","current","columnHeadersContainerElementRef","scrollLeft","getFirstColumnIndexToRenderRef","equalityCheck","a","b","every","key","updateInnerPosition","useCallback","nextRenderContext","firstRowToRender","lastRowToRender","firstIndex","firstRowIndex","lastIndex","lastRowIndex","minFirstIndex","maxLastIndex","rows","length","buffer","rowBuffer","firstColumnToRender","firstColumnIndex","columnBuffer","visibleRows","offset","style","transform","useLayoutEffect","handleScroll","left","_prevRenderContext$cu","_prevRenderContext$cu2","lastColumnIndex","canUpdateInnerPosition","flushSync","handleColumnResizeStart","params","field","handleColumnResizeStop","handleColumnReorderStart","handleColumnReorderStop","columnResizeStart","columnResizeStop","columnHeaderDragStart","columnHeaderDragEnd","rowsScroll","getColumns","other","minFirstColumn","maxLastColumn","columns","lastColumnToRender","Math","min","renderedColumns","slice","i","column","columnIndex","isFirstColumn","hasTabbableElement","tabIndex","hasFocus","open","push","columnMenuOpen","filterItemsCounter","isDragging","colIndex","isResizing","isLastColumn","extendRowFullWidth","disableExtendRowFullWidth","rootStyle","minHeight","maxHeight","lineHeight","getRootProps","getInnerProps","ref","role"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { useForkRef } from '@mui/material/utils';\nimport { defaultMemoize } from 'reselect';\nimport { useGridApiContext } from '../../utils/useGridApiContext';\nimport { useGridSelector } from '../../utils/useGridSelector';\nimport { gridVisibleColumnDefinitionsSelector, gridColumnPositionsSelector } from '../columns/gridColumnsSelector';\nimport { gridTabIndexColumnHeaderSelector, gridTabIndexCellSelector, gridFocusColumnHeaderSelector } from '../focus/gridFocusStateSelector';\nimport { gridDensityHeaderHeightSelector } from '../density/densitySelector';\nimport { gridFilterActiveItemsLookupSelector } from '../filter/gridFilterSelector';\nimport { gridSortColumnLookupSelector } from '../sorting/gridSortingSelector';\nimport { gridColumnMenuSelector } from '../columnMenu/columnMenuSelector';\nimport { useGridRootProps } from '../../utils/useGridRootProps';\nimport { useGridApiEventHandler } from '../../utils/useGridApiEventHandler';\nimport { GridEvents } from '../../../models/events';\nimport { GridColumnHeaderItem } from '../../../components/columnHeaders/GridColumnHeaderItem';\nimport { getFirstColumnIndexToRender } from '../columns/gridColumnsUtils';\nimport { useGridVisibleRows } from '../../utils/useGridVisibleRows';\nimport { getRenderableIndexes } from '../virtualization/useGridVirtualScroller';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction isUIEvent(event) {\n  return !!event.target;\n}\n\nexport const useGridColumnHeaders = props => {\n  const {\n    innerRef: innerRefProp,\n    minColumnIndex = 0\n  } = props;\n  const [dragCol, setDragCol] = React.useState('');\n  const [resizeCol, setResizeCol] = React.useState('');\n  const apiRef = useGridApiContext();\n  const visibleColumns = useGridSelector(apiRef, gridVisibleColumnDefinitionsSelector);\n  const columnPositions = useGridSelector(apiRef, gridColumnPositionsSelector);\n  const tabIndexState = useGridSelector(apiRef, gridTabIndexColumnHeaderSelector);\n  const cellTabIndexState = useGridSelector(apiRef, gridTabIndexCellSelector);\n  const columnHeaderFocus = useGridSelector(apiRef, gridFocusColumnHeaderSelector);\n  const headerHeight = useGridSelector(apiRef, gridDensityHeaderHeightSelector);\n  const filterColumnLookup = useGridSelector(apiRef, gridFilterActiveItemsLookupSelector);\n  const sortColumnLookup = useGridSelector(apiRef, gridSortColumnLookupSelector);\n  const columnMenuState = useGridSelector(apiRef, gridColumnMenuSelector);\n  const rootProps = useGridRootProps();\n  const innerRef = React.useRef(null);\n  const handleInnerRef = useForkRef(innerRefProp, innerRef);\n  const [renderContext, setRenderContext] = React.useState(null);\n  const prevRenderContext = React.useRef(renderContext);\n  const prevScrollLeft = React.useRef(0);\n  const currentPage = useGridVisibleRows(apiRef, rootProps);\n  React.useEffect(() => {\n    apiRef.current.columnHeadersContainerElementRef.current.scrollLeft = 0;\n  }, [apiRef]); // memoize `getFirstColumnIndexToRender`, since it's called on scroll\n\n  const getFirstColumnIndexToRenderRef = React.useRef(defaultMemoize(getFirstColumnIndexToRender, {\n    equalityCheck: (a, b) => ['firstColumnIndex', 'minColumnIndex', 'columnBuffer'].every(key => a[key] === b[key])\n  }));\n  const updateInnerPosition = React.useCallback(nextRenderContext => {\n    const [firstRowToRender, lastRowToRender] = getRenderableIndexes({\n      firstIndex: nextRenderContext.firstRowIndex,\n      lastIndex: nextRenderContext.lastRowIndex,\n      minFirstIndex: 0,\n      maxLastIndex: currentPage.rows.length,\n      buffer: rootProps.rowBuffer\n    });\n    const firstColumnToRender = getFirstColumnIndexToRenderRef.current({\n      firstColumnIndex: nextRenderContext.firstColumnIndex,\n      minColumnIndex,\n      columnBuffer: rootProps.columnBuffer,\n      firstRowToRender,\n      lastRowToRender,\n      apiRef,\n      visibleRows: currentPage.rows\n    });\n    const offset = firstColumnToRender > 0 ? prevScrollLeft.current - columnPositions[firstColumnToRender] : prevScrollLeft.current;\n    innerRef.current.style.transform = `translate3d(${-offset}px, 0px, 0px)`;\n  }, [columnPositions, minColumnIndex, rootProps.columnBuffer, apiRef, currentPage.rows, rootProps.rowBuffer]);\n  React.useLayoutEffect(() => {\n    if (renderContext) {\n      updateInnerPosition(renderContext);\n    }\n  }, [renderContext, updateInnerPosition]);\n  const handleScroll = React.useCallback(({\n    left,\n    renderContext: nextRenderContext = null\n  }, event) => {\n    var _prevRenderContext$cu, _prevRenderContext$cu2;\n\n    if (!innerRef.current) {\n      return;\n    } // Ignore vertical scroll.\n    // Excepts the first event which sets the previous render context.\n\n\n    if (prevScrollLeft.current === left && ((_prevRenderContext$cu = prevRenderContext.current) == null ? void 0 : _prevRenderContext$cu.firstColumnIndex) === (nextRenderContext == null ? void 0 : nextRenderContext.firstColumnIndex) && ((_prevRenderContext$cu2 = prevRenderContext.current) == null ? void 0 : _prevRenderContext$cu2.lastColumnIndex) === (nextRenderContext == null ? void 0 : nextRenderContext.lastColumnIndex)) {\n      return;\n    }\n\n    prevScrollLeft.current = left; // We can only update the position when we guarantee that the render context has been\n    // rendered. This is achieved using ReactDOM.flushSync or when the context doesn't change.\n\n    let canUpdateInnerPosition = false;\n\n    if (nextRenderContext !== prevRenderContext.current || !prevRenderContext.current) {\n      // ReactDOM.flushSync cannot be called on `scroll` events fired inside effects\n      if (isUIEvent(event)) {\n        // To prevent flickering, the inner position can only be updated after the new context has\n        // been rendered. ReactDOM.flushSync ensures that the state changes will happen before\n        // updating the position.\n        ReactDOM.flushSync(() => {\n          setRenderContext(nextRenderContext);\n        });\n        canUpdateInnerPosition = true;\n      } else {\n        setRenderContext(nextRenderContext);\n      }\n\n      prevRenderContext.current = nextRenderContext;\n    } else {\n      canUpdateInnerPosition = true;\n    } // Pass directly the render context to avoid waiting for the next render\n\n\n    if (nextRenderContext && canUpdateInnerPosition) {\n      updateInnerPosition(nextRenderContext);\n    }\n  }, [updateInnerPosition]);\n  const handleColumnResizeStart = React.useCallback(params => setResizeCol(params.field), []);\n  const handleColumnResizeStop = React.useCallback(() => setResizeCol(''), []);\n  const handleColumnReorderStart = React.useCallback(params => setDragCol(params.field), []);\n  const handleColumnReorderStop = React.useCallback(() => setDragCol(''), []);\n  useGridApiEventHandler(apiRef, GridEvents.columnResizeStart, handleColumnResizeStart);\n  useGridApiEventHandler(apiRef, GridEvents.columnResizeStop, handleColumnResizeStop);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderDragStart, handleColumnReorderStart);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderDragEnd, handleColumnReorderStop);\n  useGridApiEventHandler(apiRef, GridEvents.rowsScroll, handleScroll);\n\n  const getColumns = (params, other = {}) => {\n    const {\n      renderContext: nextRenderContext = renderContext,\n      minFirstColumn = minColumnIndex,\n      maxLastColumn = visibleColumns.length\n    } = params || {};\n\n    if (!nextRenderContext) {\n      return null;\n    }\n\n    const columns = [];\n    const [firstRowToRender, lastRowToRender] = getRenderableIndexes({\n      firstIndex: nextRenderContext.firstRowIndex,\n      lastIndex: nextRenderContext.lastRowIndex,\n      minFirstIndex: 0,\n      maxLastIndex: currentPage.rows.length,\n      buffer: rootProps.rowBuffer\n    });\n    const firstColumnToRender = getFirstColumnIndexToRenderRef.current({\n      firstColumnIndex: nextRenderContext.firstColumnIndex,\n      minColumnIndex: minFirstColumn,\n      columnBuffer: rootProps.columnBuffer,\n      apiRef,\n      firstRowToRender,\n      lastRowToRender,\n      visibleRows: currentPage.rows\n    });\n    const lastColumnToRender = Math.min(nextRenderContext.lastColumnIndex + rootProps.columnBuffer, maxLastColumn);\n    const renderedColumns = visibleColumns.slice(firstColumnToRender, lastColumnToRender);\n\n    for (let i = 0; i < renderedColumns.length; i += 1) {\n      const column = renderedColumns[i];\n      const columnIndex = firstColumnToRender + i;\n      const isFirstColumn = columnIndex === 0;\n      const hasTabbableElement = !(tabIndexState === null && cellTabIndexState === null);\n      const tabIndex = tabIndexState !== null && tabIndexState.field === column.field || isFirstColumn && !hasTabbableElement ? 0 : -1;\n      const hasFocus = columnHeaderFocus !== null && columnHeaderFocus.field === column.field;\n      const open = columnMenuState.open && columnMenuState.field === column.field;\n      columns.push( /*#__PURE__*/_jsx(GridColumnHeaderItem, _extends({}, sortColumnLookup[column.field], {\n        columnMenuOpen: open,\n        filterItemsCounter: filterColumnLookup[column.field] && filterColumnLookup[column.field].length,\n        headerHeight: headerHeight,\n        isDragging: column.field === dragCol,\n        column: column,\n        colIndex: columnIndex,\n        isResizing: resizeCol === column.field,\n        isLastColumn: columnIndex === visibleColumns.length - 1,\n        extendRowFullWidth: !rootProps.disableExtendRowFullWidth,\n        hasFocus: hasFocus,\n        tabIndex: tabIndex\n      }, other), column.field));\n    }\n\n    return columns;\n  };\n\n  const rootStyle = {\n    minHeight: headerHeight,\n    maxHeight: headerHeight,\n    lineHeight: `${headerHeight}px`\n  };\n  return {\n    renderContext,\n    getColumns,\n    isDragging: !!dragCol,\n    getRootProps: (other = {}) => _extends({\n      style: rootStyle\n    }, other),\n    getInnerProps: () => ({\n      ref: handleInnerRef,\n      'aria-rowindex': 1,\n      role: 'row'\n    })\n  };\n};"]},"metadata":{},"sourceType":"module"}